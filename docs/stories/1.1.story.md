# Story 1.1: 이메일/비밀번호 회원가입

## Status
Ready for Review

## Story
**As a** 신규 사용자,
**I want** 이메일과 비밀번호로 회원가입할 수 있도록,
**so that** AI 메모장 서비스를 이용할 수 있다

## Acceptance Criteria
1. 사용자가 이메일과 비밀번호를 입력할 수 있는 회원가입 폼을 제공한다
2. 이메일 형식 유효성 검사를 실시한다
3. 비밀번호는 최소 8자 이상이며 특수문자를 포함해야 한다
4. 중복된 이메일로는 가입할 수 없다
5. 회원가입 성공 시 확인 메시지를 표시한다
6. 회원가입 실패 시 적절한 에러 메시지를 표시한다
7. 회원가입 완료 후 자동으로 로그인 상태로 전환된다

## Tasks / Subtasks
- [x] Task 1: Supabase Auth 설정 및 환경 구성 (AC: 1, 2, 3, 4)
  - [x] Supabase 프로젝트 설정 확인
  - [x] 환경 변수 설정 (.env.local)
  - [x] Supabase 클라이언트 초기화
- [x] Task 2: 회원가입 UI 컴포넌트 구현 (AC: 1, 5, 6)
  - [x] 회원가입 페이지 생성 (/auth/signup)
  - [x] 이메일/비밀번호 입력 폼 구현
  - [x] 유효성 검사 UI 피드백
  - [x] 로딩 상태 및 에러 메시지 표시
- [x] Task 3: 회원가입 로직 구현 (AC: 2, 3, 4, 7)
  - [x] 이메일 형식 유효성 검사
  - [x] 비밀번호 길이 및 특수문자 포함 검증
  - [x] Supabase Auth signUp 함수 호출
  - [x] 중복 이메일 에러 핸들링
  - [x] 성공 시 자동 로그인 처리
- [x] Task 4: 라우팅 및 네비게이션 설정 (AC: 7)
  - [x] 회원가입 완료 후 리다이렉트 로직
  - [x] 인증 상태에 따른 페이지 접근 제어
- [x] Task 5: 테스트 작성
  - [x] 회원가입 폼 유효성 검사 테스트
  - [x] Supabase Auth 통합 테스트
  - [x] 에러 케이스 테스트

## Dev Notes

### Previous Story Insights
첫 번째 스토리이므로 이전 스토리 인사이트 없음

### Data Models
- **User Authentication**: Supabase Auth를 통한 사용자 관리
- **User Profile**: 기본 사용자 정보 (이메일, 생성일시 등)
- **Session Management**: Supabase Auth 세션 자동 관리

### API Specifications
- **Supabase Auth API**:
  - `signUp(email, password)`: 회원가입 처리
  - `signInWithPassword(email, password)`: 로그인 처리
  - `getUser()`: 현재 사용자 정보 조회
  - `onAuthStateChange()`: 인증 상태 변경 감지

### Component Specifications
- **SignUpForm Component**:
  - Props: onSubmit callback
  - State: email, password, loading, error
  - Validation: 이메일 형식, 비밀번호 길이
- **Input Components**: shadcn/ui 기반
- **Button Components**: 로딩 상태 지원

### File Locations
- `/app/auth/signup/page.tsx`: 회원가입 페이지
- `/components/auth/signup-form.tsx`: 회원가입 폼 컴포넌트
- `/lib/supabase/client.ts`: Supabase 클라이언트 설정
- `/lib/supabase/server.ts`: 서버 사이드 Supabase 설정

### Testing Requirements
- **Unit Tests**: `/__tests__/` 디렉토리에 테스트 파일 생성
- **Testing Framework**: Jest + React Testing Library
- **Test Coverage**: 폼 유효성 검사, API 호출, 에러 핸들링
- **Integration Tests**: Supabase Auth 플로우 테스트

### Technical Constraints
- **Next.js App Router**: `/app` 디렉토리 구조 사용
- **Server Actions**: 서버 사이드 로직 구현
- **Tailwind CSS**: 스타일링 전용
- **shadcn/ui**: UI 컴포넌트 라이브러리
- **TypeScript**: 타입 안전성 보장

### Security Considerations
- **Client-side**: Supabase Auth 클라이언트 사용
- **Server-side**: 환경 변수를 통한 키 관리
- **Validation**: 클라이언트 및 서버 양쪽에서 유효성 검사 (이메일 형식, 비밀번호 길이 및 특수문자 포함)
- **RLS**: Row Level Security 정책 적용 (향후 구현)

## Testing
### Testing Standards
- **Test File Location**: `/__tests__/` 디렉토리
- **Test Framework**: Jest + React Testing Library
- **Test Patterns**: 
  - Unit tests for form validation (이메일 형식, 비밀번호 길이 및 특수문자 포함)
  - Integration tests for Supabase Auth
  - Error handling tests
- **Coverage Requirements**: 핵심 기능 80% 이상 커버리지

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2024-01-XX | 1.0 | 초기 스토리 생성 | Scrum Master |
| 2024-01-XX | 1.1 | 비밀번호 요구사항에 특수문자 포함 추가 | Scrum Master |

## Dev Agent Record

### Agent Model Used
Claude Sonnet 4.5

### Debug Log References
없음 - 모든 구현이 첫 시도에 성공

### Completion Notes List
- Supabase Auth 설정 완료 (클라이언트 및 서버)
- 회원가입/로그인 UI 컴포넌트 구현 완료
- shadcn/ui 컴포넌트 (Button, Input, Label) 추가
- 유효성 검사 (이메일 형식, 비밀번호 8자 이상 + 특수문자 포함) 구현
- 에러 핸들링 (중복 이메일, 잘못된 입력 등) 구현
- 인증 상태에 따른 페이지 접근 제어 구현
- Jest + React Testing Library 테스트 환경 구축
- 8개의 테스트 케이스 작성 및 모두 통과
- 모든 코드 린트 오류 없음

### File List
#### 생성된 파일
- `.env.local` - Supabase 환경 변수
- `lib/supabase/client.ts` - 클라이언트 사이드 Supabase 클라이언트
- `lib/supabase/server.ts` - 서버 사이드 Supabase 클라이언트
- `components/ui/button.tsx` - Button 컴포넌트
- `components/ui/input.tsx` - Input 컴포넌트
- `components/ui/label.tsx` - Label 컴포넌트
- `components/auth/signup-form.tsx` - 회원가입 폼 컴포넌트
- `components/auth/signin-form.tsx` - 로그인 폼 컴포넌트
- `app/auth/signup/page.tsx` - 회원가입 페이지
- `app/auth/signin/page.tsx` - 로그인 페이지
- `app/auth/signout/route.ts` - 로그아웃 서버 액션
- `jest.config.js` - Jest 설정
- `jest.setup.js` - Jest 환경 설정
- `__tests__/signup-form.test.tsx` - 회원가입 폼 테스트
- `__tests__/auth-integration.test.tsx` - Supabase Auth 통합 테스트
- `.env.test` - 테스트 환경 변수

#### 수정된 파일
- `app/page.tsx` - 인증 상태에 따른 UI 표시 및 네비게이션
- `package.json` - 테스트 스크립트 추가

#### 설치된 패키지
- `@supabase/supabase-js` - Supabase 클라이언트
- `@supabase/ssr` - Supabase SSR 지원
- `@radix-ui/react-slot` - Radix UI Slot
- `@radix-ui/react-label` - Radix UI Label
- `@hookform/resolvers` - Form 유효성 검사
- `zod` - 스키마 유효성 검사
- `react-hook-form` - Form 관리
- `jest` - 테스트 프레임워크
- `@testing-library/react` - React 테스트 라이브러리
- `@testing-library/jest-dom` - Jest DOM 매처
- `jest-environment-jsdom` - Jest JSDOM 환경

## QA Results
*QA 에이전트가 검토 후 작성*
